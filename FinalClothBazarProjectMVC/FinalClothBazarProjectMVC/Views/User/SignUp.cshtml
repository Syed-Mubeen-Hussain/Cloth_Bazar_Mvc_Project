@model User

@if (ViewBag.error != null)
{
    <div class="alert alert-danger" role="alert">
        @ViewBag.error
    </div>
}
<div class="container">
    <div>

        <div class="row">
            <div class="col-md-12">
                <div class="title-section">
                    <h2 class="title">
                        Sign Up
                    </h2>
                </div><!-- /.title-section -->
            </div><!-- /.col-md-12 -->
        </div>
        <section>

            <div>

                <div class="row">
                    <div class="col-md-12">
                        <section id="loginForm">
                            <form action="@Url.Action("SignUp","User")" method="post">
                                <div class="form-group">
                                    <label>First Name</label>
                                    <input type="text" class="form-control" name="u_firstname" placeholder="First Name">
                                </div>
                                <div class="form-group">
                                    <label>Last Name</label>
                                    <input type="text" class="form-control" name="u_lastname" placeholder="Last Name">
                                </div>
                                <div class="form-group">
                                    <label>Gender</label>
                                    @Html.DropDownListFor(x => x.u_gender, new SelectList(new[] { "Male", "Female" }), "Select Gender", new { @class = "form-control", name = "u_gender" })
                                </div>
                                <div class="form-group">
                                    <label>Image</label>
                                    <input type="hidden" id="ImageURL" name="u_image" />
                                    <input id="imageUpload" class="form-control" name="Image" type="file" accept=".png, .jpg" />
                                </div>
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" class="form-control" name="u_email" placeholder="Email">
                                </div>
                                <div class="form-group">
                                    <label>Username</label>
                                    <input type="text" class="form-control" name="u_username" placeholder="Username">
                                </div>
                                <div class="form-group">
                                    <label>Password</label>
                                    <input type="password" class="form-control" name="u_password" placeholder="Password">
                                </div>
                                <button type="submit" class="btn btn-primary">Sign Up</button>
                            </form>
                        </section>
                    </div>
                </div>

            </div>


        </section>
    </div>
</div>


<script>
    $("#imageUpload").change(function () {
        var element = this;

        var formData = new FormData();

        var totalFiles = element.files.length;

        for (var i = 0; i < totalFiles; i++) {
            var file = element.files[i];
            formData.append("Photo", file);
        }

        $.ajax({
            type: 'POST',
            url: '@Url.Action("UploadImage", "Shared")',
            dataType: 'json',
            data: formData,
            contentType: false,
            processData: false
        })
            .done(function (response) {
                console.log(response);

                if (response.Success) {
                    $("#ImageURL").val(response.ImageURL);
                    $("#productImage").attr("src", response.ImageURL);
                }
            })
            .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                alert("FAIL");
            });
    });
</script>